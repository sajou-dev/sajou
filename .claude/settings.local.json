{
  "permissions": {
    "allow": [
      "Bash(pnpm add:*)",
      "Bash(npm --version:*)",
      "Bash(node:*)",
      "Bash(corepack enable:*)",
      "Bash(pnpm:*)",
      "Bash(npm install:*)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA status)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA diff)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA log --oneline -5)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA add:*)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA commit -m \"$\\(cat <<''EOF''\nchore\\(root\\): initialize pnpm monorepo with TypeScript and Vitest\n\nSet up pnpm workspaces, strict tsconfig base, vitest config,\nand root scripts for typecheck/test.\nEOF\n\\)\")",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA commit -m \"$\\(cat <<''EOF''\ndocs\\(schema\\): add ADR-001 signal protocol design\n\nEnvelope + typed payload pattern with 7 V1 signal types.\nCompares flat model, envelope+payload, and event sourcing approaches.\nEOF\n\\)\")",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA commit -m \"$\\(cat <<''EOF''\nfeat\\(schema\\): implement V1 signal protocol JSON Schema and TypeScript types\n\n- signal.schema.json: envelope + typed payload for 7 signal types\n- signal-types.ts: aligned TypeScript types with discriminated union\n- SignalEvent narrows payload via switch on type field\n- All payload fields readonly \\(immutable signals\\)\n- 9 tests covering all signal types and type narrowing\nEOF\n\\)\")",
      "Bash(git checkout:*)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA checkout -b feat/emitter)",
      "Bash(pnpm run typecheck:*)",
      "Bash(pnpm test:*)",
      "Bash(pnpm install:*)",
      "Bash(pnpm typecheck:*)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA log --oneline -3)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA branch:*)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA checkout feat/emitter)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA diff tsconfig.json)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA diff pnpm-lock.yaml)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA commit -m \"$\\(cat <<''EOF''\nfeat\\(emitter\\): implement @sajou/emitter with scenarios and WebSocket server\n\n- Signal factory with auto-incrementing IDs and typed creation\n- Scenario runner with realistic delays, speed control, and loop replay\n- 3 predefined scenarios: simple-task, error-recovery, multi-agent\n- WebSocket server broadcasting signals to all connected clients\n- CLI entry point with --scenario, --port, --speed, --no-loop flags\n- 23 tests covering factory, runner, and scenario validation\nEOF\n\\)\")",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA checkout main)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA merge feat/emitter)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA push origin main)",
      "Bash(npx tsc:*)",
      "Bash(git stash:*)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA log main..feat/core-choreographer-runtime --oneline)",
      "Bash(git restore:*)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA stash list)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA diff main feat/core-choreographer-runtime --stat)",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA log --oneline --all --graph)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA checkout -b feat/integration-pipeline)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA commit -m \"$\\(cat <<''EOF''\nfeat\\(theme-citadel\\): add declarative choreographies for Citadel theme\n\n4 choreography definitions matching the manifesto''s vision:\n- task_dispatch: move\\(peon\\) → spawn\\(pigeon\\) → fly → onArrive\\(destroy, flash\\)\n- error: spawn\\(explosion\\) → flash\\(red\\) → playSound \\(interrupts: true\\)\n- tool_call: flash\\(forge, blue\\)\n- token_usage: spawn\\(gold-coins\\) → wait → destroy\n\nAdds @sajou/core dependency for ChoreographyDefinition type.\nEOF\n\\)\")",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA commit -m \"$\\(cat <<''EOF''\ntest\\(integration\\): end-to-end pipeline signal → choreographer → commands\n\n11 integration tests proving the full Sajou pipeline works:\n- Citadel choreographies registered in choreographer\n- Emitter signal factory creates typed signals\n- task_dispatch produces: move → spawn → fly → onArrive\\(destroy → flash\\)\n- error produces: spawn\\(explosion\\) → flash\\(red\\) → playSound\n- error interrupts active task_dispatch via correlationId\n- Unrelated workflows are not interrupted\n- All 7 signal types accepted without runtime errors\n\nAdds workspace packages as root devDependencies for cross-package testing.\nAdds theme-api and theme-citadel to root tsconfig references.\nBridge function toPerformanceSignal\\(\\) adapts typed SignalEnvelope to\nthe choreographer''s PerformanceSignal interface.\nEOF\n\\)\")",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA log --oneline feat/integration-pipeline ^main)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA merge feat/integration-pipeline)",
      "WebSearch",
      "WebFetch(domain:bundlephobia.com)",
      "Bash(curl:*)",
      "Bash(npm view:*)",
      "Bash(gzip:*)",
      "Bash(ls:*)",
      "Bash(lsof:*)",
      "Bash(xargs:*)",
      "Bash(npx --yes playwright --version)",
      "Bash(npx playwright install:*)",
      "Bash(find:*)",
      "Bash(__NEW_LINE_d342b3253140164a__ echo \"\")",
      "Bash(while read f)",
      "Bash(do echo \"$f\")",
      "Bash(done)",
      "Bash(git merge:*)",
      "Bash(git push:*)",
      "Bash(sips:*)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA diff --stat)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA checkout -b feat/declarative-entity-visuals)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA commit -m \"$\\(cat <<''EOF''\nfeat\\(schema\\): add entity visual config JSON Schema and TypeScript types\n\nDeclarative format for theme entity visuals. Each entity has named\nstates \\(idle, run, attack...\\) discriminated on type: \"static\" for\nsingle images and \"spritesheet\" for animated frame sequences.\nIncludes ajv-based schema validation tests \\(11 tests\\).\nEOF\n\\)\")",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA commit -m \"$\\(cat <<''EOF''\nfeat\\(theme-citadel\\): declarative entity visuals replace hardcoded config\n\nReplace ENTITY_VISUALS constant in PixiCommandSink with a declarative\nentity-visuals.json config. Each entity defines named states \\(idle,\nrun\\) with static or spritesheet rendering params. Asset loads are\ndeduplicated. Includes lightweight structural validator \\(warns, does\nnot throw\\) and 26 new tests.\nEOF\n\\)\")",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA commit -m \"$\\(cat <<''EOF''\nchore\\(dev\\): wire dev playground to declarative entity visuals\n\nPass citadelEntityVisuals to PixiCommandSink options instead of\nusing the old positional constructor.\nEOF\n\\)\")",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA merge feat/declarative-entity-visuals --no-ff -m \"Merge branch ''feat/declarative-entity-visuals''\")",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA push)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA checkout -b feat/entity-editor)",
      "Bash(echo:*)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA commit -m \"$\\(cat <<''EOF''\nchore: add tools/* to pnpm workspace\nEOF\n\\)\")",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA commit -m \"$\\(cat <<''EOF''\nfeat\\(entity-editor\\): standalone visual entity editor for Sajou themes\n\nNew tool in tools/entity-editor/ — a polished standalone app for\nconfiguring entity → asset mappings declaratively.\n\nFeatures:\n- Asset browser: drag & drop folders or file picker, recursive scan,\n  thumbnails in a collapsible file tree\n- Entity list: add/rename/delete entities with color dot and state count\n- Entity config: displayWidth/Height sliders, fallbackColor picker\n- State management: add/remove named states \\(idle, run, attack...\\)\n- State config: static/spritesheet toggle, asset binding from browser,\n  spritesheet params \\(frameSize, frameCount, frameRow, fps, loop\\),\n  sourceRect cropping for static sprites\n- Live preview: PixiJS canvas renders the current state in real time\n- Export: generates entity-visuals.json \\(schema-conformant\\) + referenced\n  assets bundled into a downloadable zip via JSZip\n- Import: load an existing entity-visuals.json to edit\n\nStack: Vite + vanilla TS + CSS, PixiJS for previews, JSZip for export.\nDark theme, product-quality UI. No framework.\n\nRun: pnpm --filter entity-editor dev\nEOF\n\\)\")",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA log --oneline feat/entity-editor ^main)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA merge feat/entity-editor --no-ff -m \"Merge branch ''feat/entity-editor''\")",
      "Bash(python3:*)",
      "Bash(git status:*)",
      "Bash(sort:*)",
      "Bash(open:*)",
      "WebFetch(domain:limezu.itch.io)",
      "Bash(file:*)",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA commit -m \"$\\(cat <<''EOF''\nfeat\\(themes\\): polish Citadel and Office scenes for proportions and decor\n\nCitadel:\n- Peon display size 64→72 for better visibility vs buildings\n- Repositioned layout: castle y:80→130, forges y:220→310, spawn/gold y:500→520\n- Added buildStaticDecoration\\(\\) with 18 sprites: 4 tree stumps, 4 rocks,\n  6 deco pebbles, 4 fence/signpost items from Tiny Swords assets\n- Decoration assets added to manifest preload list\n\nOffice:\n- Worker 48×72→40×60, server-rack 72×108→56×84, manager-desk 96×72→72×54\n- All 37 furniture sprites now have explicit scale \\(0.4-0.65\\) for\n  coherent proportions relative to the smaller worker\n- Replaced Singles 164 \\(colorful sofa\\) with Singles 198 \\(neutral cabinet\\)\n- Plants reduced to 0.4-0.5 scale, desks 0.6, chairs 0.55\nEOF\n\\)\")",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA merge feat/scene-polish --no-ff -m \"Merge branch ''feat/scene-polish''\")",
      "Bash(git -C /Users/yan/synoul415/devel/sajou_AA commit -m \"$\\(cat <<''EOF''\nfix\\(themes\\): hide one-shot AnimatedSprite immediately on completion\n\nOne-shot animations \\(explosion, gold-coins spawn\\) briefly flashed\na fallback rectangle between the last animation frame and destroy.\n\nRoot cause: PixiJS onComplete fires after the animation tick but\nbefore the next render pass commits the removal. A render frame\ncould still draw the entity in a stale state.\n\nFix: set visible=false in both the onComplete callback and at the\ntop of handleDestroy, ensuring no frame is ever rendered between\nanimation end and entity removal.\nEOF\n\\)\")",
      "Bash(PLAYWRIGHT_BROWSERS_PATH=$HOME/.cache/ms-playwright npx playwright install:*)",
      "Bash(osascript:*)",
      "Bash(git rm:*)",
      "Bash(git fetch:*)",
      "Bash(export PATH=\"/opt/homebrew/bin:$PATH\")",
      "Bash(npx vite build:*)",
      "WebFetch(domain:lucide.dev)",
      "WebFetch(domain:unpkg.com)",
      "Bash(./node_modules/.bin/tsc:*)",
      "Bash(git log:*)",
      "Bash(/opt/homebrew/bin/npx tsc --noEmit)",
      "Bash(/opt/homebrew/bin/npx tsc --version)",
      "Bash(/opt/homebrew/bin/npx vite build)",
      "Bash(/opt/homebrew/bin/pnpm install:*)",
      "Bash(export PATH=\"/opt/homebrew/bin:/usr/bin:$PATH\")",
      "Bash(export PATH=\"/opt/homebrew/bin:/usr/bin:/bin:/usr/sbin:/sbin:$PATH\")",
      "Bash(kill:*)",
      "Bash(wait:*)",
      "Bash(npx tsx:*)",
      "Bash(git -C:*)",
      "Bash(npx sajou-emit:*)",
      "Bash(git branch:*)",
      "Bash(in iso view\".\nEOF\n\\)\")",
      "WebFetch(domain:github.com)",
      "WebFetch(domain:docs.openclaw.ai)",
      "WebFetch(domain:deepwiki.com)",
      "WebFetch(domain:www.npmjs.com)",
      "WebFetch(domain:medium.com)",
      "Bash(git pull:*)",
      "Bash(cat:*)",
      "Bash(grep:*)",
      "Bash(git tag:*)",
      "Bash(wc:*)"
    ]
  },
  "hooks": {
    "PreToolUse": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "npx sajou-emit --stdin",
            "timeout": 5,
            "statusMessage": "sajou-tap",
            "async": true
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "npx sajou-emit --stdin",
            "timeout": 5,
            "statusMessage": "sajou-tap",
            "async": true
          }
        ]
      }
    ],
    "PostToolUseFailure": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "npx sajou-emit --stdin",
            "timeout": 5,
            "statusMessage": "sajou-tap",
            "async": true
          }
        ]
      }
    ],
    "SubagentStart": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "npx sajou-emit --stdin",
            "timeout": 5,
            "statusMessage": "sajou-tap",
            "async": true
          }
        ]
      }
    ],
    "SubagentStop": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "npx sajou-emit --stdin",
            "timeout": 5,
            "statusMessage": "sajou-tap",
            "async": true
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "npx sajou-emit --stdin",
            "timeout": 5,
            "statusMessage": "sajou-tap",
            "async": true
          }
        ]
      }
    ]
  }
}
